---
import { getEntry } from "astro:content";
import BaseLayout from "~/layouts/BaseLayout.astro";
import { DEFAULT_LOCALE } from "~/i18n/config";
import { buildPageData } from "~/i18n/page-data";
import FaqAccordion from "~/components/content/FaqAccordion.astro";

const locale = DEFAULT_LOCALE;
const pathname = "/faq/";
const { site } = Astro;
const pageData = buildPageData(locale, site, pathname);
const { head } = pageData;
const htmlLang = "en";

const entry = await getEntry("faq", "en");
if (!entry) {
  throw new Error("Missing FAQ data for en");
}

const title = "PC Ambilight FAQ | Screen Sync RGB Lighting Answers";
const intro =
  "Short answers first, then links to full steps for setup, low-latency tuning, and troubleshooting.";

const structuredDataExtra = [
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "@id": `${head.canonical}#faq`,
    url: head.canonical,
    inLanguage: htmlLang,
    mainEntity: entry.data.items.map((item) => ({
      "@type": "Question",
      name: item.q,
      acceptedAnswer: {
        "@type": "Answer",
        text: item.a,
      },
    })),
  },
];
---

<BaseLayout
  locale={locale}
  pathname={pathname}
  title={title}
  description={intro}
  structuredDataExtra={structuredDataExtra}
>
  <header class="space-y-3">
    <h1 class="text-3xl font-semibold tracking-tight">{title}</h1>
    <p class="max-w-3xl text-sm text-offset">
      {intro}
    </p>
  </header>

  <div class="mt-8">
    <FaqAccordion items={entry.data.items} />
  </div>
</BaseLayout>


---
import { getCollection } from "astro:content";
import BaseLayout from "~/layouts/BaseLayout.astro";
import type { Locale } from "~/i18n/config";
import { buildPageData } from "~/i18n/page-data";
import { localizePathname } from "~/i18n/config";

const locale: Locale = "zh";
const { site } = Astro;
const pageData = buildPageData(locale, site, "/best-picks/");
const { copy } = pageData;

const title = "推荐榜单：3 分钟完成 PC Ambilight 选型";
const intro = "先给结论，再讲原因。按场景快速选型，再进入下载或安装。";

const entries = await getCollection("bestPicks", (e) =>
  e.slug.startsWith(`${locale}/`),
);
const items = entries
  .map((e) => {
    const slug = e.slug.split("/").slice(1).join("/");
    return {
      slug,
      title: e.data.title,
      description: e.data.description,
      href: localizePathname(locale, `/${slug}/`),
      updatedAt: e.data.updatedAt,
    };
  })
  .sort((a, b) => (b.updatedAt?.getTime() ?? 0) - (a.updatedAt?.getTime() ?? 0));
---

<BaseLayout
  locale={locale}
  pathname="/best-picks/"
  title={title}
  description={intro}
>
  <header class="space-y-3">
    <h1 class="text-3xl font-semibold tracking-tight">{title}</h1>
    <p class="max-w-3xl text-sm text-offset">
      {intro}
    </p>
  </header>

  <section class="mt-8 rounded-2xl border border-default bg-offset p-6">
    <h2 class="text-lg font-semibold tracking-tight">{copy.common.tldr}</h2>
    <p class="mt-2 text-sm text-offset">
      如果你想最少折腾，优先选稳定默认项。进阶灯效和复杂自动化放到第二阶段。
    </p>
    <p class="mt-2 text-sm text-offset">
      Skydimo 支持官网、Microsoft Store 与 Steam 下载。
    </p>
  </section>

  <div class="mt-8 grid gap-4 sm:grid-cols-2">
    {items.map((item) => (
      <a
        class="rounded-2xl border border-default bg-offset p-6 hover:border-secondary"
        href={item.href}
      >
        <div class="text-sm font-semibold">{item.title}</div>
        <p class="mt-2 text-sm text-offset">{item.description}</p>
        <div class="mt-4 text-xs text-offset">{copy.common.readMore} →</div>
      </a>
    ))}
  </div>
</BaseLayout>

